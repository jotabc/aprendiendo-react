import{jsx as _jsx}from"react/jsx-runtime";import{useEffect,useState,Children}from"react";import{EVENTS}from"./const";import{match}from"path-to-regexp";import{getCurrentPath}from"./utils";export function Router({children,routes=[],defaultComponent:DefaultComponent=()=>null}){const[currentPath,setCurrentPath]=useState(getCurrentPath());useEffect(()=>{const onLocationChange=()=>{setCurrentPath(getCurrentPath())};window.addEventListener(EVENTS.PUSHSTATE,onLocationChange);window.addEventListener(EVENTS.POPSTATE,onLocationChange);return()=>{window.removeEventListener(EVENTS.PUSHSTATE,onLocationChange);window.removeEventListener(EVENTS.POPSTATE,onLocationChange)}},[]);let routesParams={};const routesFromChildren=Children.map(children,({props,type})=>{const{name}=type;const isRoute=name==="Route";if(!isRoute)return null;return props});const routesToUse=routes.concat(routesFromChildren).filter(Boolean);if(routesToUse.length===0){return _jsx(DefaultComponent,{})}const Page=routesToUse.find(({path})=>{if(path===currentPath)return true;const matchedUrl=match(path,{decode:decodeURIComponent});const matched=matchedUrl(currentPath);if(!matched)return false;routesParams=matched.params;return true})?.Component;return Page?_jsx(Page,{routesParams:routesParams}):_jsx(DefaultComponent,{})}